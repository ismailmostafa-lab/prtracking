<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Enterprise Project Management – PR Tracking</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{font-family:Cairo;background:#f5f2fb;margin:0}
.header{background:linear-gradient(135deg,#9b6ab8,#5c3b8c);color:#fff;padding:30px;text-align:center;border-radius:0 0 30px 30px}
.container{max-width:1300px;margin:20px auto;background:#fff;padding:30px;border-radius:20px}
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px}
label{font-weight:600}
input,select{padding:12px;border-radius:12px;border:1px solid #ddd;width:100%}
.actions{text-align:center;margin-top:30px}
button{padding:12px 30px;border:none;border-radius:16px;background:#6b3fa0;color:#fff;font-size:15px;cursor:pointer}
.hidden{display:none}
.readonly input,.readonly select{background:#eee;pointer-events:none}
</style>
</head>

<body>

<div class="header">
  <h1>Enterprise Project Management</h1>
  <p>PR Tracking System</p>
</div>

<div class="container">

  <input id="searchPR" placeholder="Enter PR Number">
  <button onclick="searchPR()">Search</button>
  <button onclick="newPR()">New</button>

  <div id="form" class="readonly">
    <div class="grid">

      <div><label>PR</label><input data-field="PR"></div>
      <div><label>PR Creation Date</label><input type="date" data-field="PR Creation Date"></div>
      <div><label>PR Approval Date</label><input type="date" data-field="PR Approval Date"></div>
      <div><label>PR Status</label><select data-field="PR Status"><option>Approved</option><option>In Progress</option><option>Cancelled</option></select></div>

      <div><label>PR Amount</label><input data-field="PR Amount"></div>
      <div><label>PR Currency</label><select data-field="PR Currency"><option>EGP</option><option>USD</option></select></div>
      <div><label>Buyer</label><input data-field="Buyer"></div>
      <div><label>Description</label><input data-field="Description"></div>

      <div><label>Vendor Name</label><input data-field="Vendor Name"></div>
      <div><label>Purchase Status</label><select data-field="Purchase Status"><option>Rent</option><option>Sale</option></select></div>
      <div><label>Order Place</label><select data-field="Order Place"><option>TE data store</option><option>Customer store</option></select></div>
      <div><label>ECRM Order</label><input data-field="ECRM Order"></div>

      <div><label>Order Type</label><select data-field="Order Type"><option>HW</option><option>License</option><option>Cross connection</option></select></div>
      <div><label>Quantity / Speed</label><input data-field="Quantity / Speed"></div>
      <div><label>Customer Name</label><input data-field="Customer Name"></div>
      <div><label>Customer PO Amount</label><input data-field="Customer PO Amount"></div>

      <div><label>PO Currency</label><select data-field="PO Currency"><option>EGP</option><option>USD</option></select></div>
      <div><label>Customer PO</label><input data-field="Customer PO"></div>
      <div><label>Payment Status Description</label><input data-field="Payment Status Description"></div>
      <div><label>Customer Type</label><select data-field="Customer Type"><option>BS</option><option>KAM</option><option>TE International</option><option>Global Partner</option></select></div>

      <div><label>Project Manager</label><input data-field="Project Manager"></div>
      <div><label>Account Manager</label><input data-field="Account Manager"></div>
      <div><label>Get Final Price</label><select data-field="Get Final Price"><option>Done</option><option>Pending</option></select></div>
      <div><label>Final Price</label><input type="date" data-field="Final Price"></div>

      <div><label>Memo’s Sent</label><input type="date" data-field="Memo’s Sent"></div>
      <div><label>LOI Issued</label><input type="date" data-field="LOI Issued"></div>
      <div><label>PO Issued</label><input type="date" data-field="PO Issued"></div>

    </div>

    <div class="actions">
      <button onclick="editMode()">Edit</button>
      <button onclick="savePR()">Save</button>
      <button onclick="deletePR()">Delete</button>
    </div>
  </div>

</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbyfkTuWS1lJ3C3W-3DNGoF8cDPR6-Q92UOpwAuUoKPFp05DomDGnGoN7UYaEHWbVuth/exec";
let currentPR = null;

async function searchPR(){
  const pr = document.getElementById('searchPR').value;
  const r = await fetch(API,{method:'POST',body:JSON.stringify({action:'searchPR',PR:pr})});
  const j = await r.json();
  if(j.status!=='success') return alert("Not found");

  currentPR = pr;
  document.querySelectorAll('[data-field]').forEach(el=>{
    el.value = j.data[el.dataset.field] || '';
  });
}

function editMode(){
  document.getElementById('form').classList.remove('readonly');
}

async function savePR(){
  const data = {};
  document.querySelectorAll('[data-field]').forEach(el=>data[el.dataset.field]=el.value);
  await fetch(API,{method:'POST',body:JSON.stringify({action:'savePR',data})});
  alert("Saved");
}

async function deletePR(){
  await fetch(API,{method:'POST',body:JSON.stringify({action:'deletePR',PR:currentPR})});
  location.reload();
}

function newPR(){
  document.querySelectorAll('[data-field]').forEach(el=>el.value='');
  editMode();
}
</script>

</body>
</html>
